<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="nlmixr: an R package for population PKPD modeling" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This is the start of setting up a user’s guide and reference manual for nlmixr" />


<meta name="author" content="Matthew Fidler, Teun Post, Richard Hooijmaijers, Rik Schoemaker, Mirjam Trame, Justin Wilkins, Yuan Xiong and Wenping Wang" />

<meta name="date" content="2018-05-11" />


<meta name="description" content="This is the start of setting up a user’s guide and reference manual for nlmixr">

<title>nlmixr: an R package for population PKPD modeling</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
\usepackage{booktabs}


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#welcome-to-population-modeling-with-r">Welcome to population modeling with R</a></li>
<li class="has-sub"><a href="preface.html#preface">Preface</a><ul>
<li><a href="about-this-book.html#about-this-book">About this book</a></li>
<li><a href="acknowledgements.html#acknowledgements">Acknowledgements</a></li>
</ul></li>
<li class="has-sub"><a href="1-intro.html#intro"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="1-1-prereq.html#prereq"><span class="toc-section-number">1.1</span> Prerequisites</a></li>
<li><a href="1-2-workflow.html#workflow"><span class="toc-section-number">1.2</span> Workflow</a></li>
</ul></li>
<li class="has-sub"><a href="2-install.html#install"><span class="toc-section-number">2</span> Installation</a><ul>
<li class="has-sub"><a href="2-1-nlmixr.html#nlmixr"><span class="toc-section-number">2.1</span> <code>nlmixr</code></a><ul>
<li><a href="2-1-nlmixr.html#windows-installer"><span class="toc-section-number">2.1.1</span> Windows installer</a></li>
<li><a href="2-1-nlmixr.html#installation-on-windows"><span class="toc-section-number">2.1.2</span> Installation on Windows</a></li>
<li><a href="2-1-nlmixr.html#installation-on-linux"><span class="toc-section-number">2.1.3</span> Installation on Linux</a></li>
<li><a href="2-1-nlmixr.html#installation-on-macos"><span class="toc-section-number">2.1.4</span> Installation on macOS</a></li>
</ul></li>
<li><a href="2-2-shinymixr-project-management-tool-for-nlmixr.html#shinymixr-project-management-tool-for-nlmixr"><span class="toc-section-number">2.2</span> <code>ShinyMixR</code>: project management tool for <code>nlmixr</code></a></li>
</ul></li>
<li class="has-sub"><a href="3-vignettes.html#vignettes"><span class="toc-section-number">3</span> <code>nlmixr</code> vignettes</a><ul>
<li class="has-sub"><a href="3-1-interface.html#interface"><span class="toc-section-number">3.1</span> <code>ShinyMixR</code> - project-centric interface</a><ul>
<li><a href="3-1-interface.html#introduction"><span class="toc-section-number">3.1.1</span> Introduction</a></li>
<li><a href="3-1-interface.html#getting-started"><span class="toc-section-number">3.1.2</span> Getting started</a></li>
<li><a href="3-1-interface.html#overview"><span class="toc-section-number">3.1.3</span> Overview</a></li>
<li><a href="3-1-interface.html#edit-models"><span class="toc-section-number">3.1.4</span> Edit models</a></li>
<li><a href="3-1-interface.html#run-models"><span class="toc-section-number">3.1.5</span> Run models</a></li>
<li><a href="3-1-interface.html#parameter-estimates"><span class="toc-section-number">3.1.6</span> Parameter estimates</a></li>
<li><a href="3-1-interface.html#goodness-of-fit"><span class="toc-section-number">3.1.7</span> Goodness of fit</a></li>
<li><a href="3-1-interface.html#fit-plots"><span class="toc-section-number">3.1.8</span> Fit plots</a></li>
<li><a href="3-1-interface.html#scripts"><span class="toc-section-number">3.1.9</span> Scripts</a></li>
<li><a href="3-1-interface.html#results"><span class="toc-section-number">3.1.10</span> Results</a></li>
<li><a href="3-1-interface.html#interactive-session"><span class="toc-section-number">3.1.11</span> Interactive session</a></li>
</ul></li>
<li class="has-sub"><a href="3-2-nlmixr-modeling-mini-language.html#nlmixr-modeling-mini-language"><span class="toc-section-number">3.2</span> <code>nlmixr</code> modeling mini-language:</a><ul>
<li><a href="3-2-nlmixr-modeling-mini-language.html#rationale"><span class="toc-section-number">3.2.1</span> Rationale</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-applications.html#applications"><span class="toc-section-number">4</span> Applications of <code>nlmixr</code></a><ul>
<li><a href="4-1-demo-examples-from-github.html#demo-examples-from-github"><span class="toc-section-number">4.1</span> Demo Examples from GitHub</a></li>
<li><a href="4-2-posters-and-presentations.html#posters-and-presentations"><span class="toc-section-number">4.2</span> Posters and Presentations</a></li>
<li class="has-sub"><a href="4-3-sparse-data-analysis-with-nlmixr.html#sparse-data-analysis-with-nlmixr"><span class="toc-section-number">4.3</span> Sparse data analysis with <code>nlmixr</code></a><ul>
<li><a href="4-3-sparse-data-analysis-with-nlmixr.html#examination-of-nlmixr-estimation-algorithm-properties-for-sparse-sample-data"><span class="toc-section-number">4.3.1</span> Examination of nlmixr estimation algorithm properties for sparse sample data</a></li>
</ul></li>
<li><a href="4-4-course-page-2018.html#course-page-2018"><span class="toc-section-number">4.4</span> Course PAGE 2018</a></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="interface" class="section level2">
<h2><span class="header-section-number">3.1</span> <code>ShinyMixR</code> - project-centric interface</h2>
<div id="introduction" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Introduction</h3>
<!-- # ```{r echo=FALSE, results='hide'} -->
<!-- # knitr::opts_chunk$set(fig.width=7, fig.height=4)  -->
<!-- # ``` -->
<p>The <code>nlmixr</code> package can be accessed through command line in <code>R</code> and <code>RStudio</code>, and through an graphical user interface <code>ShinyMixR</code> supported by the <code>nlmixr</code> team. Both command line and interface support the integration with <a href="https://github.com/nlmixrdevelopment/xpose.nlmixr"><code>xpose.nlmixr</code></a>.</p>
<p><code>ShinyMixR</code> aims to provide a user-friendly tool for <code>nlmixr</code> based on <a href="https://shiny.rstudio.com/"><code>Shiny</code></a>, which facilitates a workflow around an <code>nlmixr</code> project. It is build as a project-centric, instead of interface-centric, workflow around <code>nlmixr</code> from the <code>R</code> command line and from a streamlined <code>Shiny</code> application. The <a href="https://cran.r-project.org/web/packages/shinydashboard/shinydashboard.pdf"><code>shinydashboard</code></a> package was used to set up a structure for controlling and tracking runs with an nlmixr project, and was the basis for setting up the modular interface.</p>
<p>This project tool enhances the usability and attractiveness of <code>nlmixr</code>, facilitating dynamic and interactive use in real-time for rapid model development. In this project-oriented structure, the command line and dashboard can be used independently and/or interdependently. This means that many of the functions within the package can also be used outside the interface within an interactive R session.</p>
<p>Using the <code>ShinyMixR</code>, the user specifies and controls an <code>nlmixr</code> project workflow entirely in <code>R</code>. Within a project folder, a structure can be created to include separate folders for models, data and runs. Functionality is available to edit and run model code, summarize and compare model outputs in a tabular fashion, and view model development using a tree paradigm. Inputs, outputs and metadata are stored in relation to the model code within the project structure (a discrete R object) to ensure traceability.</p>
<p>Results are visualized by using modifications of existing packages (such as <a href="https://github.com/nlmixrdevelopment/xpose.nlmixr"><code>xpose.nlmixr</code></a>, user-written functions and packages, or pre-existing plotting functionality included in the <code>ShinyMixR</code> package. Results are reported using the <a href="https://github.com/RichardHooijmaijers/R3port">R3port</a> package in pdf and html format.</p>
<p>How the package can be used and what the most important functions are, is described in this section. When working with this package, there are two important assumptions:</p>
<ol style="list-style-type: decimal">
<li>A specific folder structure is in place. The package uses this structure to read and write certain files (the folder structure can be generated automatically using the <code>create_proj</code> function).</li>
<li>Within a folder structure, multiple models can be present and is considered a “project”. The package creates and manages a project object which is available in the global environment.</li>
</ol>
<p>An introduction on how to use the <code>ShinyMixR</code> interface can be found <a href="https://richardhooijmaijers.github.io/shinyMixR/index.html">here</a>. To get started, first install the package and use the library.</p>
</div>
<div id="getting-started" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Getting started</h3>
<p>To get started, first install the package using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;richardhooijmaijers/shinyMixR&quot;</span>)</code></pre></div>
<p>Be aware that the <code>nlmixr</code>, <code>nlmixr.xpose</code> and <code>R3port</code> package should be installed before installing <code>shinyMixR</code>, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;richardhooijmaijers/R3port&quot;</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;nlmixrdevelopment/nlmixr&quot;</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;nlmixrdevelopment/xpose.nlmixr&quot;</span>)</code></pre></div>
<p>The easiest way to get to know the package is to create the folder structure (which include some example models):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shinyMixR,<span class="dt">quietly =</span> <span class="ot">TRUE</span>)
<span class="kw">create_proj</span>()</code></pre></div>
<p>By default, a folder structure is created within the current directory. The following folders are created:</p>
<ul>
<li>analysis: in this folder all plots and tables are saved in a structured way to make them accesible to the interface</li>
<li>data: data files used by the models in R data format (.rds)</li>
<li>models: models, available as separate R scripts according the unified user interface in <code>nlmixr</code></li>
<li>scripts: generic analysis scipts made available in the interface</li>
<li>shinyMixR: folder used by the interface to store temporarly files and results files</li>
</ul>
<p>The interface monitors what happens in these folders. This is important to know because new models and/or data can be copied into these folders or files can be removed. This will then be recognized within the app (after refreshing the overview). This way it is possible to work on data and models separately and plug it in to shinyMixR at a later stage.</p>
<p>Once there is a folder structure present the interface can be started:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">run_shinymixr</span>(<span class="dt">launch.browser =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>The interface will be started and a project object will be created in the global environment in which all information is kept/managed. If correct, the interface will open in the default browser and the following will be seen:</p>
<p><img src="figures/screen1.png" width="80%" style="display: block; margin: auto;" /></p>
<!-- <img src="screen1.png" width="700"> -->
<p>On the left side, there is sidebar with various menu items. The content of the main body will open with the model overview but will change based on the selected menu item in the sidebar. The sidebar can be collapsed by clicking the three lines in the top bar, providing more room for the main body.</p>
</div>
<div id="overview" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Overview</h3>
<p>The overview page can be used to see which models are present in a project, the relationship between models and to adapt model meta data. The overview can be exported to a CSV file and a selection of columns can be made that should be displayed (all using the <code>DT</code> package).</p>
</div>
<div id="edit-models" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Edit models</h3>
<p><img src="figures/screen2.png" width="80%" style="display: block; margin: auto;" /></p>
<!-- <img src="screen2.png" width="300"> -->
<p>The edit tab can be used to edit existing models within an editor including syntax coloring (using <code>shinyAce</code>). It is also possible to create new models using various templates or to duplicate existing models.</p>
</div>
<div id="run-models" class="section level3">
<h3><span class="header-section-number">3.1.5</span> Run models</h3>
<p><img src="figures/screen3.png" width="80%" style="display: block; margin: auto;" /></p>
<!-- <img src="screen3.png" width="300"> -->
<p>The run tab can be used to run models within a project. It is possible to run one or multiple models at once. Also it is possible to assess the intermediate output or progress for an nlmixr run.</p>
</div>
<div id="parameter-estimates" class="section level3">
<h3><span class="header-section-number">3.1.6</span> Parameter estimates</h3>
<p><img src="figures/screen4.png" width="80%" style="display: block; margin: auto;" /></p>
<!-- <img src="screen4.png" width="300"> -->
<p>The parameter estimates tab can be used to generate a table with parameter estimates. In case multiple models are selected the table will show the results of each run in a separate column. This page is reactive which means that in case a different model is selected, the table is directly updated. There is also the possiblity to save the table to a latex/pdf or html file.</p>
</div>
<div id="goodness-of-fit" class="section level3">
<h3><span class="header-section-number">3.1.7</span> Goodness of fit</h3>
<p><img src="figures/screen5.png" width="80%" style="display: block; margin: auto;" /> <!-- <img src="screen5.png" width="300"> --></p>
<p>The goodness of fit tab can be used to generate a combination of 4 goodness of fit plots combined. By default nlmixr.xpose is used but direct ggplot can also be used by specifying this in the settings. Also here the plots can be saved to a latex/pdf or html file.</p>
</div>
<div id="fit-plots" class="section level3">
<h3><span class="header-section-number">3.1.8</span> Fit plots</h3>
<p><img src="figures/screen6.png" width="80%" style="display: block; margin: auto;" /> <!-- <img src="screen6.png" width="300"> --></p>
<p>The fit plots tab can be used to generate a individual fit plots. The same options are present here as for the goodness of fit plots.</p>
</div>
<div id="scripts" class="section level3">
<h3><span class="header-section-number">3.1.9</span> Scripts</h3>
<p><img src="figures/screen7.png" width="80%" style="display: block; margin: auto;" /> <!-- <img src="screen7.png" width="300"> --></p>
<p>It is possible to write your own scripts that can be used to analyse model results. This script can be used to process the result for one or multiple models at once (the interface will include the name of the selected models in the script). An example of how such a script will look like is included in the package.</p>
</div>
<div id="results" class="section level3">
<h3><span class="header-section-number">3.1.10</span> Results</h3>
<p><img src="figures/screen8.png" width="80%" style="display: block; margin: auto;" /> <!-- <img src="screen8.png" width="300"> --></p>
<p>It is possible to view and combine the results from the models within a project within the last tab.</p>
</div>
<div id="interactive-session" class="section level3">
<h3><span class="header-section-number">3.1.11</span> Interactive session</h3>
<p>When working in an interactive R session, many functions used by the interface are also available from an interactive R session. When working outside the interface it is important to know how to interact with the project object. This object should be created as one of the first steps because other function rely on the availability of this object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">proj_obj &lt;-<span class="st"> </span><span class="kw">get_proj</span>()</code></pre></div>
<p>This function will look in the folder structure to create or update the available information. The result is a list that is build-up as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">object
<span class="op">|---</span><span class="st"> </span>run <span class="dv">1</span>
<span class="op">|</span><span class="st">    </span><span class="er">|</span><span class="op">---</span><span class="st"> </span>model location
<span class="op">|</span><span class="st">    </span><span class="er">|</span><span class="op">---</span><span class="st"> </span>model meta data
<span class="op">|</span><span class="st">    </span><span class="er">|</span><span class="op">---</span><span class="st"> </span>model high level results
<span class="op">|</span>
<span class="er">|</span><span class="op">---</span><span class="st"> </span>...
<span class="op">|</span>
<span class="er">|</span><span class="op">---</span><span class="st"> </span>meta <span class="kw">data</span> (time of last refresh)</code></pre></div>
<p>In case this object is not present it will be created by looking at the files present in the current folder structure. In case the object is already present it will check if newer files are present in the current folder and will update the object with this information. Therefore one have to be aware that this function should be submitted manually in case new information is present in the one of the folders.</p>
<p>Once a folder structure is in place and the project object is created, an overview can be created for the available models and, if models are submitted, high level results. It is also possible to display a collapsible d3 tree view of the models. This is mainly useful in case reference to models is provided to show the hierachy of the models within a project:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">overview</span>()
<span class="kw">tree_overview</span>()</code></pre></div>
<p>Although the <code>nlmixr</code> package obiously has the possibilty to run nlmixr models, the shinyMixR package also have a function available named <code>run_nmx</code>. the main reason this function was written is the option to run the model in an external R session. This is necessary within the interface to overcome the application from freezing when a model is submitted. Also within an interactive R session it is convenient because you do not have to wait for a run to finish. An example how this can be used is given below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#proj_obj &lt;- get_proj()</span>
<span class="co">#run_nmx(&quot;run1&quot;,proj=proj_obj)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">run_nmx</span>(<span class="st">&quot;run1&quot;</span>,<span class="dt">proj=</span>proj_obj)
<span class="co"># progress of a run is written to external text file</span>
<span class="co"># this can be read-in for intermediate assessment</span>
<span class="kw">readLines</span>(<span class="st">&quot;shinyMixR/temp/run1.prog.txt&quot;</span>)</code></pre></div>
<p>The current version of the package has three functions for assessing the model results. The first function is to create a simple parameter table <code>par_table</code>. By default this function returns a data.frame. In case multiple models are selected, each column will have the results of the selected model. The results can also be written to a PDF (using latex) or html file using the <code>R3port</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par_table</span>(proj_obj,<span class="kw">c</span>(<span class="st">&quot;run1&quot;</span>,<span class="st">&quot;run2&quot;</span>))
<span class="co"># par_table(proj_obj, models=&quot;run1&quot;, outnm=&quot;par.tex&quot;)</span></code></pre></div>
<p>For assessing the goodness of fit, the <code>gof_plot</code> function can be used. This function will by default use the <code>nlmixr.xpose</code> package to create 4 different types of plots. It is also possible to directly create ggplot2 types of plots. By default the plots will be created within the R session but can also be written to pdf/html using the <code>R3port</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res  &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;./shinyMixR/run1.res.rds&quot;</span>)
<span class="kw">gof_plot</span>(res)
<span class="co"># gof_plot(res, mdlnm=&quot;run1&quot;, outnm=&quot;gof.tex&quot;)</span></code></pre></div>
<p>The last plot is an individual fit plot <code>fit_plot</code>. This function will also by default use the <code>nlmixr.xpose</code> package to create a plot per individual including the observed data, indivual and population predictions. Also here it is possible to create ggplot2 types of plots and plots can be outputted to pdf/html:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fit_plot</span>(res, <span class="dt">type=</span><span class="st">&quot;user&quot;</span>)
<span class="co"># fit_plot(res, mdlnm=&quot;run1&quot;, outnm=&quot;fit.html&quot;)</span></code></pre></div>
<!-- nlmixr vignette -->
</div>
</div>
<p style="text-align: center;">
<a href="3-vignettes.html"><button class="btn btn-default">Previous</button></a>
<a href="3-2-nlmixr-modeling-mini-language.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
