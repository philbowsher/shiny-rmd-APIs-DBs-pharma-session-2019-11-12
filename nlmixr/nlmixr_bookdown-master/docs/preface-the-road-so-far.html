<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Preface: The Road So Far | nlmixr: an R package for population PKPD modeling</title>
  <meta name="description" content="This is the start of setting up a user’s guide and reference manual for nlmixr" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Preface: The Road So Far | nlmixr: an R package for population PKPD modeling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the start of setting up a user’s guide and reference manual for nlmixr" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Preface: The Road So Far | nlmixr: an R package for population PKPD modeling" />
  
  <meta name="twitter:description" content="This is the start of setting up a user’s guide and reference manual for nlmixr" />
  

<meta name="author" content="Matthew Fidler, Teun M. Post, Richard Hooijmaijers, Rik Schoemaker, Mirjam N. Trame, Justin Wilkins, Yuan Xiong and Wenping Wang" />


<meta name="date" content="2019-06-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html">
<link rel="next" href="intro.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">nlmixr User's guide and Reference Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to population modeling in R</a></li>
<li class="chapter" data-level="" data-path="preface-the-road-so-far.html"><a href="preface-the-road-so-far.html"><i class="fa fa-check"></i>Preface: The Road So Far</a><ul>
<li class="chapter" data-level="" data-path="preface-the-road-so-far.html"><a href="preface-the-road-so-far.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="preface-the-road-so-far.html"><a href="preface-the-road-so-far.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#prereq"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#workflow"><i class="fa fa-check"></i><b>1.2</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="install.html"><a href="install.html#nlmixr"><i class="fa fa-check"></i><b>2.1</b> <code>nlmixr</code></a><ul>
<li class="chapter" data-level="2.1.1" data-path="install.html"><a href="install.html#installation-via-docker"><i class="fa fa-check"></i><b>2.1.1</b> Installation via Docker</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="install.html"><a href="install.html#shinymixr-project-management-tool"><i class="fa fa-check"></i><b>2.2</b> <code>shinyMixR</code>: project management tool</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vignettes.html"><a href="vignettes.html"><i class="fa fa-check"></i><b>3</b> <code>nlmixr</code> vignettes</a><ul>
<li class="chapter" data-level="3.1" data-path="vignettes.html"><a href="vignettes.html#nlmixr-1"><i class="fa fa-check"></i><b>3.1</b> <code>nlmixr</code></a><ul>
<li class="chapter" data-level="3.1.1" data-path="vignettes.html"><a href="vignettes.html#rationale"><i class="fa fa-check"></i><b>3.1.1</b> Rationale</a></li>
<li class="chapter" data-level="3.1.2" data-path="vignettes.html"><a href="vignettes.html#some-examples"><i class="fa fa-check"></i><b>3.1.2</b> Some examples</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vignettes.html"><a href="vignettes.html#xpose"><i class="fa fa-check"></i><b>3.2</b> <code>xpose.nlmixr</code></a><ul>
<li class="chapter" data-level="3.2.1" data-path="vignettes.html"><a href="vignettes.html#introduction"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="vignettes.html"><a href="vignettes.html#getting-started"><i class="fa fa-check"></i><b>3.2.2</b> Getting started</a></li>
<li class="chapter" data-level="3.2.3" data-path="vignettes.html"><a href="vignettes.html#overview"><i class="fa fa-check"></i><b>3.2.3</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vignettes.html"><a href="vignettes.html#interface"><i class="fa fa-check"></i><b>3.3</b> <code>shinyMixR</code></a><ul>
<li class="chapter" data-level="3.3.1" data-path="vignettes.html"><a href="vignettes.html#introduction-1"><i class="fa fa-check"></i><b>3.3.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications of <code>nlmixr</code></a><ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#posters-presentations-and-publications"><i class="fa fa-check"></i><b>4.1</b> Posters, Presentations and Publications</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>nlmixr</code>: an R package for population PKPD modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="preface-the-road-so-far" class="section level1 unnumbered">
<h1>Preface: The Road So Far</h1>
<p>In pharmacometrics there are several population pharmacokinetic and pharmacodynamic modeling software packages. The <code>nlmixr</code> R package was developed for fitting general dynamic models, pharmacokinetic (PK) models and pharmacokinetic-pharmacodynamic (PKPD) models in particular, with either individual data or population data. The interesting part about <code>nlmixr</code> is that it is open-source and the entire workflow of modeling can be done solely in R!</p>
<p><code>nlmixr</code> has its roots in <code>RxODE</code>. Once <code>RxODE</code> was built it was soon recognized that by combining <code>RxODE</code> with a nonlinear mixed-effect model (NLME) estimation tool, one greatly expands an existing NLME tool to include fitting a population PK/PD model described by a set of ordinary differential equations (ODEs) and by allowing complex and arbitrary dosing history.</p>
<p>The first attempt was to combine <code>RxODE</code> with the <code>nlme()</code> function in R, resulting in two efficient and useful functions for population PK/PD: <code>nlme_lin_cmpt()</code> and <code>nlme_ode()</code>. After the initial success of these functions, stochastic approximation expectation maximization (SAEM) was subsequently added to the <code>nlmixr</code> toolbox. While maintaining fidelity to the original SAEM algorithm, the <code>nlmixr</code> implementation of SAEM was written from scratch using <code>C++</code> with many optimizations and re-factorizations in comparison to the original implementation. The resulting SAEM code is compact and efficient. Since execution of <code>nlmixr</code>’s SAEM is in compiled <code>C++</code> mode, the speed of the implementation is relatively fast.</p>
<p>A function for the generalized nonlinear mixed-effect model (<code>gnlmm</code>) was developed to address project needs. This function <code>gnlmm()</code> takes an arbitrary user-defined log-likelihood function and hence is able to fit odd types of data like binary data, count data, heavy tail data and bounded clinical endpoints via beta-regression. Structure models can be optionally defined by user-defined ODEs.</p>
<p>These population PK/PD functions, plus a number of ancillary functions to aid model building (including support for VPCs, bootstraps and stepwise forward selection of covariates), comprised the functionality of the first public release of <code>nlmixr</code> in October 2016.</p>
<p>In early 2017, a publication on the use of sensitivity equations in first-order conditional estimation with interaction (FOCEi) by <a href="https://link.springer.com/article/10.1007/s10928-015-9409-1">Almquist and colleagues</a> was brought to the attention of the <code>nlmixr</code> team, and a proof-of-concept implementation was soon put in place. A full production version will soon be completed.</p>
<p><code>nlmixr</code>’s population PK/PD functions are highly optimized and efficient. However, due to historic reasons (e.g., <code>nlme</code>’s original user interface) and specific input-output needs, different algorithms in <code>nlmixr</code> had similar but subtly different user interfaces. To reduce the learning curve of population PK/PD modeling, the <code>nlmixr</code> team proposed and implemented a unified user-interface (UUI) across all fitting algorithms in mid-2017. The result is a minimalist, intuitive, expressive, domain-specific population PK/PD modeling language. A comprehensive collection of nlme algorithms with the UUI marked the first CRAN release of <code>nlmixr</code> in October 2017.</p>
<p><code>nlmixr</code> remains under active, intensive development, and exciting features and functionality emerge almost on a daily basis. For instance, parallel computing has recently become available in <code>RxODE</code> via the <code>openmp</code> package. This parallel computing capability is the industry’s first among the current population PK/PD simulators to the best of our knowledge. Clinical trial simulation (CTS) was added to <code>nlmixr</code> in May 2018 and is capable of extensive and sophisticated CTS right after a population PK/PD model with <code>nlmixr</code>.</p>
<p>We hope you enjoy <code>nlmixr</code>!</p>
<p><em><strong>Wenping Wang</strong></em></p>
<div id="about-this-book" class="section level2 unnumbered">
<h2>About this book</h2>
<p>This book provides basic guidance on the use of <code>nlmixr</code> and serves as a basic reference manual, although we do not cover every aspect of modeling or <code>nlmixr</code>. Whenever possible, this manual refers to the individual pkgdown sites and/or github sites of the separate packages.</p>
<p>We assume readers have a background in pharmacometric modeling and know how to use R. Basic knowledge is required and assumed on installing other software packages, such as Python. The installation of <code>nlmixr</code> and related software and packages is described in Chapter <a href="install.html#install">2</a>.</p>
</div>
<div id="acknowledgements" class="section level2 unnumbered">
<h2>Acknowledgements</h2>
<p>We are thankful for the time people have been willing to spend on this project. There have been various interactions and contributions on GitHub, which we really appreciate. We would like to thank James Cavenaugh, <a href="https://github.com/NeutralKaon">NeutralKaon</a>, <a href="https://github.com/ronkeizer">ronkeizer</a>, <a href="https://github.com/nholford">nholford</a>, <a href="https://github.com/kylebaron">kylebaron</a>, <a href="https://github.com/DimitrisVoul">DimitrisVoul</a>, <a href="https://github.com/ericwongyc">ericwongyc</a>, <a href="https://github.com/tamas-ferenci">tamas-ferenci</a>, <a href="https://github.com/karthikl6">karthikl6</a>, <a href="https://github.com/bildenny">billdenny</a>, <a href="https://github.com/amaisahmad">amaisahmad</a>, <a href="https://github.com/bgoodri">bgoodri</a>, <a href="https://github.com/cfosser">cfosser</a>, <a href="https://github.com/rfaelens">rfaelens</a>, <a href="https://github.com/dryoutao">dryoutao</a>, <a href="https://github.com/jfstanding">jfstanding</a>, <a href="https://github.com/SCarter79">SCarter79</a>, <a href="https://github.com/MikeKSmith">MikeKSmith</a>, and many more.</p>
<!-- First chapter -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
